<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.progzc.ke.mapper.CourseMapper">

    <select id="queryListByCourseId" resultType="com.progzc.ke.entity.Course">
        SELECT * FROM course WHERE course_id = #{id} ORDER BY log_date DESC LIMIT 0,#{count}
    </select>
    <select id="querySellingSumByCourseIds" resultType="java.lang.Long">
        SELECT SUM(o.selling_quantity)
        FROM
        (SELECT selling_quantity
        FROM course
        WHERE course_id IN
        <foreach item="item" index="index" open="(" separator="," close=")" collection="idList">
            #{item}
        </foreach>
        ORDER BY log_date DESC LIMIT 0,#{count}) AS o
    </select>
    <select id="queryViewSumByCourseIds" resultType="java.lang.Long">
        SELECT SUM(o.page_view)
        FROM
        (SELECT page_view
        FROM course
        WHERE course_id IN
        <foreach item="item" index="index" open="(" separator="," close=")" collection="idList">
            #{item}
        </foreach>
        ORDER BY log_date DESC LIMIT 0,#{count}) AS o
    </select>
    <select id="querySellingSumByCourseId" resultType="java.lang.Long">
        SELECT SUM(o.selling_quantity)
        FROM (SELECT selling_quantity FROM course WHERE course_id = #{id} ORDER BY log_date DESC LIMIT 0,#{count}) AS o
    </select>
    <select id="ViewSumByCourseId" resultType="java.lang.Long">
        SELECT SUM(o.page_view)
        FROM (SELECT page_view FROM course WHERE course_id = #{id} ORDER BY log_date DESC LIMIT 0,#{count}) AS o
    </select>
</mapper>
